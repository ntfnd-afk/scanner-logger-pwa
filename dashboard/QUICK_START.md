# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - Scanner Dashboard

## üìã –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### ‚úÖ –ì–æ—Ç–æ–≤–æ:
- üìä –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª —Å –≥—Ä–∞—Ñ–∏–∫–æ–º
- üì¶ –ö–æ—Ä–æ–±–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∞—Ç—Ä—ë—à–∫–∏)
- üìù –°—ã—Ä—ã–µ –ª–æ–≥–∏ —Å –ø–æ–∏—Å–∫–æ–º
- üíæ –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
- üé® –î–∏–∑–∞–π–Ω –≤ —Å—Ç–∏–ª–µ WBD

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏:
- üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —à—Ç—Ä–∏—Ö–∫–æ–¥–æ–≤ (–Ω—É–∂–µ–Ω API)
- üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ XLSX (–Ω—É–∂–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)

---

## üéØ –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è?

### 1. **–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª**
```
üìä –ì—Ä–∞—Ñ–∏–∫ ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏–∫—É –∑–∞ 14 –¥–Ω–µ–π
üìà –ú–µ—Ç—Ä–∏–∫–∏ ‚Üí –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
üë• –û–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚Üí –∫–ª–∏–∫–∞–π –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
```

### 2. **–ö–æ—Ä–æ–±–∞**
```
üè¢ –ö–ª–∏–µ–Ω—Ç ‚Üí –∫–ª–∏–∫–∞–π
  ‚îî‚îÄ üèôÔ∏è –ì–æ—Ä–æ–¥ ‚Üí –∫–ª–∏–∫–∞–π
      ‚îî‚îÄ üì¶ –ö–æ—Ä–æ–± ‚Üí –∫–ª–∏–∫–∞–π
          ‚îî‚îÄ üè∑Ô∏è –®—Ç—Ä–∏—Ö–∫–æ–¥ ‚Üí –∫–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å"
```

### 3. **–°—ã—Ä—ã–µ –ª–æ–≥–∏**
```
üîç –ü–æ–∏—Å–∫ ‚Üí —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º
üìÑ –ü–∞–≥–∏–Ω–∞—Ü–∏—è ‚Üí 50 –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
üé® –ë–µ–π–¥–∂–∏ ‚Üí —Ü–≤–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π
```

### 4. **–≠–∫—Å–ø–æ—Ä—Ç**
```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Üí –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–æ—Ä—Ç–æ–º
üì• CSV ‚Üí —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚ö†Ô∏è XLSX ‚Üí –ø–æ–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω—É–∂–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
```

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–¥–µ–ª–∞—Ç—å?

### Backend (Python/FastAPI):

#### 1. API –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —à—Ç—Ä–∏—Ö–∫–æ–¥–æ–≤:
```python
# backend/app/api/v1/endpoints/events.py

@router.delete("/events/{event_uuid}")
async def delete_event(
    event_uuid: str,
    db: AsyncSession = Depends(get_db),
    current_user: str = Depends(verify_api_key)
):
    """–ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è"""
    # 1. –ù–∞–π—Ç–∏ —Å–æ–±—ã—Ç–∏–µ
    event = await db.get(Event, event_uuid)
    if not event:
        raise HTTPException(404, "Event not found")
    
    # 2. –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∏—è
    deletion = Deletion(
        event_uuid=event_uuid,
        deleted_by=current_user,
        deleted_at=datetime.now(),
        event_data=event.to_dict()
    )
    db.add(deletion)
    
    # 3. –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω–æ–µ
    event.deleted = True
    event.deleted_at = datetime.now()
    
    await db.commit()
    return {"ok": True}
```

#### 2. API –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —É–¥–∞–ª–µ–Ω–∏–π:
```python
@router.get("/deletions")
async def get_deletions(
    date: str = None,
    operator: str = None,
    client: str = None,
    db: AsyncSession = Depends(get_db)
):
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª–µ–Ω–∏–π"""
    query = select(Deletion).order_by(Deletion.deleted_at.desc())
    
    if date:
        query = query.filter(Deletion.deleted_at >= date)
    if operator:
        query = query.filter(Deletion.deleted_by == operator)
    
    result = await db.execute(query)
    deletions = result.scalars().all()
    
    return {
        "deletions": [d.to_dict() for d in deletions],
        "total": len(deletions)
    }
```

#### 3. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É deletions:
```python
# backend/app/models/deletion.py

class Deletion(Base):
    __tablename__ = "deletions"
    
    id = Column(Integer, primary_key=True)
    event_uuid = Column(String, nullable=False)
    deleted_by = Column(String, nullable=False)
    deleted_at = Column(DateTime, default=datetime.now)
    event_data = Column(JSON)  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
```

### Frontend (React):

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è XLSX:
```bash
cd dashboard
npm install xlsx
```

#### 2. –û–±–Ω–æ–≤–∏—Ç—å ExportNew.jsx:
```javascript
import * as XLSX from 'xlsx';

const exportToXLSX = () => {
  const ws = XLSX.utils.json_to_sheet(exportData);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Scanner Data");
  XLSX.writeFile(wb, `scanner_export_${new Date().toISOString().split('T')[0]}.xlsx`);
};
```

#### 3. –î–æ–±–∞–≤–∏—Ç—å API –∫–ª–∏–µ–Ω—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:
```javascript
// dashboard/src/api/client.js

export async function deleteEvent(eventUuid) {
  return fetchAPI(`/events/${eventUuid}`, {
    method: 'DELETE'
  });
}

export async function getDeletions(filters = {}) {
  const params = new URLSearchParams();
  if (filters.date) params.append('date', filters.date);
  if (filters.operator) params.append('operator', filters.operator);
  
  return fetchAPI(`/deletions?${params.toString()}`);
}
```

#### 4. –û–±–Ω–æ–≤–∏—Ç—å BoxesNew.jsx:
```javascript
import { deleteEvent } from '../api/client';

const handleDeleteItem = async (itemUuid, boxCode, clientName, cityName) => {
  if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —à—Ç—Ä–∏—Ö–∫–æ–¥ –∏–∑ –∫–æ—Ä–æ–±–∞?')) return;

  try {
    await deleteEvent(itemUuid);
    alert('–®—Ç—Ä–∏—Ö–∫–æ–¥ —É–¥–∞–ª—ë–Ω!');
    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
    window.location.reload();
  } catch (error) {
    console.error('Error deleting item:', error);
    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏');
  }
};
```

---

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä—å –≥—Ä–∞—Ñ–∏–∫:
- –û—Ç–∫—Ä–æ–π "–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª"
- –ì—Ä–∞—Ñ–∏–∫ –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ 14 –¥–Ω–µ–π
- –ú–µ—Ç—Ä–∏–∫–∏ —Å–ø—Ä–∞–≤–∞ –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è

### 2. –ü—Ä–æ–≤–µ—Ä—å –∫–æ—Ä–æ–±–∞:
- –û—Ç–∫—Ä–æ–π "–ö–æ—Ä–æ–±–∞"
- –ö–ª–∏–∫–Ω–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞ ‚Üí –¥–æ–ª–∂–Ω—ã —Ä–∞—Å–∫—Ä—ã—Ç—å—Å—è –≥–æ—Ä–æ–¥–∞
- –ö–ª–∏–∫–Ω–∏ –Ω–∞ –≥–æ—Ä–æ–¥ ‚Üí –¥–æ–ª–∂–Ω—ã —Ä–∞—Å–∫—Ä—ã—Ç—å—Å—è –∫–æ—Ä–æ–±–∞
- –ö–ª–∏–∫–Ω–∏ –Ω–∞ –∫–æ—Ä–æ–± ‚Üí –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —à—Ç—Ä–∏—Ö–∫–æ–¥—ã

### 3. –ü—Ä–æ–≤–µ—Ä—å —Å—ã—Ä—ã–µ –ª–æ–≥–∏:
- –û—Ç–∫—Ä–æ–π "–°—ã—Ä—ã–µ –ª–æ–≥–∏"
- –í–≤–µ–¥–∏ —á—Ç–æ-—Ç–æ –≤ –ø–æ–∏—Å–∫
- –ü—Ä–æ–≤–µ—Ä—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é

### 4. –ü—Ä–æ–≤–µ—Ä—å —ç–∫—Å–ø–æ—Ä—Ç:
- –û—Ç–∫—Ä–æ–π "–≠–∫—Å–ø–æ—Ä—Ç"
- –ù–∞–∂–º–∏ "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å CSV"
- –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–∫–∞—á–∞—Ç—å—Å—è

---

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç–∞:
```css
/* dashboard/src/App.css */

/* –û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç */
#1976D2 ‚Üí —Ç–≤–æ–π —Ü–≤–µ—Ç

/* –£—Å–ø–µ—Ö */
#4CAF50 ‚Üí —Ç–≤–æ–π —Ü–≤–µ—Ç

/* –û—à–∏–±–∫–∞ */
#C62828 ‚Üí —Ç–≤–æ–π —Ü–≤–µ—Ç
```

### –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ:
```javascript
// dashboard/src/components/DashboardNew.jsx

for (let i = 13; i >= 0; i--) {  // 14 –¥–Ω–µ–π
// –ò–∑–º–µ–Ω–∏ –Ω–∞:
for (let i = 29; i >= 0; i--) {  // 30 –¥–Ω–µ–π
```

### –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:
```javascript
// dashboard/src/components/RawLogsNew.jsx

const itemsPerPage = 50;
// –ò–∑–º–µ–Ω–∏ –Ω–∞:
const itemsPerPage = 100;
```

---

## üêõ Troubleshooting

### –ì—Ä–∞—Ñ–∏–∫ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ?
- –ü—Ä–æ–≤–µ—Ä—å —Ñ–∏–ª—å—Ç—Ä—ã (–¥–∞—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–µ–≥–æ–¥–Ω—è)
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –µ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è —Ç–∏–ø–∞ `ITEM`
- –û—Ç–∫—Ä–æ–π DevTools ‚Üí Console

### –ö–æ—Ä–æ–±–∞ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç—Å—è?
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ —Å `client`, `city`, `box`
- –ü—Ä–æ–≤–µ—Ä—å Console –Ω–∞ –æ—à–∏–±–∫–∏

### –≠–∫—Å–ø–æ—Ä—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ
- –ü—Ä–æ–≤–µ—Ä—å Console –Ω–∞ –æ—à–∏–±–∫–∏
- –ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä

---

**–ì–æ—Ç–æ–≤–æ!** üéâ

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø–∏—à–∏! üí¨

